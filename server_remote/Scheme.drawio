<mxfile host="app.diagrams.net" modified="2021-09-08T14:52:13.598Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36" etag="-p-jYra2OrU2HdwCJ8Ph" version="15.1.0" type="github">
  <diagram id="kgpKYQtTHZ0yAKxKKP6v" name="Page-1">
    <mxGraphModel dx="1185" dy="735" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="3nuBFxr9cyL0pnOWT2aG-1" value="TPM2.0" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="80" y="80" width="120" height="1150" as="geometry" />
        </mxCell>
        <mxCell id="3nuBFxr9cyL0pnOWT2aG-5" value="Device" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="320" y="80" width="120" height="1170" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-3" value="Attestor" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="560" y="80" width="120" height="1170" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-5" value="TPM Manufacturer" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="1110" y="80" width="120" height="510" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-15" value="READ" style="verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="184.99666666666673" y="30.000000000000142" as="targetPoint" />
            <mxPoint x="290" y="30" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-16" value="WRITE" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="290" y="50" as="sourcePoint" />
            <mxPoint x="184" y="50" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-21" value="" style="group;fontStyle=1;fontSize=13;" parent="1" vertex="1" connectable="0">
          <mxGeometry x="50" y="140" width="70" height="80" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-12" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="PK25MbMjysthuU5o7wJD-21" vertex="1">
          <mxGeometry x="50" width="20" height="80" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-14" value="Certification&lt;br&gt;Creation" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="PK25MbMjysthuU5o7wJD-21" vertex="1">
          <mxGeometry x="-10" y="30" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-22" value="" style="group;fontStyle=1;fontSize=13;" parent="1" vertex="1" connectable="0">
          <mxGeometry x="55" y="360" width="70" height="290" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-23" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="PK25MbMjysthuU5o7wJD-22" vertex="1">
          <mxGeometry x="50" y="130" width="20" height="160" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-24" value="Attune" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="PK25MbMjysthuU5o7wJD-22" vertex="1">
          <mxGeometry y="190" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-1" value="Read EK PuK" style="verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1170" y="160" as="targetPoint" />
            <mxPoint x="150" y="160" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-2" value="Store certificate EK cert" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1170" y="210" as="sourcePoint" />
            <mxPoint x="140" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-3" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1170.003529411765" y="152" as="sourcePoint" />
            <mxPoint x="1170.003529411765" y="207.99999999999977" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1220.68" y="152" />
              <mxPoint x="1220.68" y="208" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-4" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Create certificate&lt;br&gt;using MPiK&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-3" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="67" y="28" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-5" value="&lt;font style=&quot;font-size: 15px&quot;&gt;&lt;span&gt;Legend:&lt;/span&gt;&lt;br&gt;KP: key pair (PiK + PuK)&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;PuK: Public Key&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;PiK: Private Key&lt;br&gt;&lt;/span&gt;Key PubDara: Public key + Attributes key&lt;br&gt;Aut KP: Key stored in the server used to authorize the use of the sealed KP&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;Manufacturer: Creator of the IoT oracle&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;MPiK: Manufacturer PiK&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;Device: Microcontroller (or any devices) controlling the oracle&lt;/span&gt;&lt;br&gt;&lt;div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;IoT_O: IoT oracle (device + HSM)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="1100" y="453" width="520" height="170" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-9" value="&lt;b&gt;&lt;font style=&quot;font-size: 13px&quot;&gt;Device arrives&lt;br&gt;&amp;nbsp;end user&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="25" y="260" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-12" value="Send AK PuBData +&#xa;EK PuBData +&#xa;Ref_Me +&#xa;One-use key&#xa;" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry x="0.0052" y="-15" relative="1" as="geometry">
            <mxPoint x="381.25" y="538" as="sourcePoint" />
            <mxPoint x="620" y="538" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-17" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140.00352941176493" y="340" as="sourcePoint" />
            <mxPoint x="140.00352941176493" y="395.99999999999966" as="targetPoint" />
            <Array as="points">
              <mxPoint x="190.68000000000006" y="340" />
              <mxPoint x="190.68000000000006" y="396" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-18" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Create AK&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-17" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="47" y="20" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-26" value="&lt;font style=&quot;font-size: 15px&quot;&gt;*tpm2_loadexternal -G rsa -C o -u signing_key_public.pem -c signing_key.ctx -n signing_key.name&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="20" y="1270" width="670" height="20" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-44" value="AutPuK" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="140" y="717" as="sourcePoint" />
            <mxPoint x="380" y="717" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-48" value="CA" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="880" y="80" width="120" height="1190" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-49" value="" style="endArrow=none;html=1;strokeWidth=3;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="125" y="270" as="sourcePoint" />
            <mxPoint x="1260" y="270" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-52" value="AK PuBData + EK PuBData" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="141.25" y="500" as="sourcePoint" />
            <mxPoint x="380" y="500" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-53" value="EK PuBData" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="140" y="330" as="sourcePoint" />
            <mxPoint x="378.75" y="330" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-54" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="620.0035294117652" y="537" as="sourcePoint" />
            <mxPoint x="620.0035294117652" y="592.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="670.6800000000001" y="537" />
              <mxPoint x="670.6800000000001" y="593" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-55" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate:&lt;br&gt;One-use key&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px ; font-weight: 700&quot;&gt;EK PuBData&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;,&lt;br&gt;Assert AK is an &lt;br&gt;attestation key (attributes)&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Make_credential(EKPuK,&lt;br&gt;Ak_name,AutPuK)&lt;br&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-54" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="100" y="45" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-56" value="Credential" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="380" y="630" as="targetPoint" />
            <mxPoint x="620" y="630" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-57" value="One-use Key, Attestor_IP" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="380" y="430" as="targetPoint" />
            <mxPoint x="620" y="430" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-58" value="One-use key to verify Device is Device,&lt;br&gt;and to lock the registration&lt;br&gt;&amp;nbsp;process to only one use" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="620" y="280" width="220" height="50" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-59" value="Send Credential" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="140" y="630" as="targetPoint" />
            <mxPoint x="380" y="630" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-60" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140.00352941176493" y="647" as="sourcePoint" />
            <mxPoint x="140.00352941176493" y="702.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="190.68000000000006" y="647" />
              <mxPoint x="190.68000000000006" y="703" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-61" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Activate_credential(&lt;br&gt;EKPuK, AK_name,&lt;br&gt;credential)&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-60" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="77" y="20" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-63" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140.00352941176493" y="727" as="sourcePoint" />
            <mxPoint x="140.00352941176493" y="782.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="190.68000000000006" y="727" />
              <mxPoint x="190.68000000000006" y="783" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-64" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Create sealed key (SeK)&lt;br&gt;sealed to AutPuK&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-63" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="77" y="15" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-66" value="Send Sealedkey_PuBData" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="140" y="797" as="sourcePoint" />
            <mxPoint x="380" y="797" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-67" value="Send SeK_PuBData" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="380" y="797" as="sourcePoint" />
            <mxPoint x="620" y="797" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-68" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380.00352941176516" y="1223" as="sourcePoint" />
            <mxPoint x="380.00352941176516" y="1278.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="430.68000000000006" y="1223" />
              <mxPoint x="430.68000000000006" y="1279" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-69" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Nomal working process:&lt;br&gt;Generate data,&lt;br&gt;Generate Data digest&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-68" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="80" y="12" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-70" value="&lt;font&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;**&lt;/span&gt;&lt;span style=&quot;color: rgb(36 , 41 , 46)&quot;&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;tpm2_policyauthorize -S session.ctx -L authorized.policy -n signing_key.name&lt;/font&gt;&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="20" y="1310" width="540" height="20" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-2" value="Send Sealedkey_PuBK" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="620" y="1040" as="sourcePoint" />
            <mxPoint x="940" y="1040" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-3" value="Send certificate  (CA-&gt;SealedKey)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="620" y="1080" as="targetPoint" />
            <mxPoint x="940" y="1080" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-4" value="Send certificate (CA-&gt;SealedKey)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="380" y="1080" as="targetPoint" />
            <mxPoint x="630" y="1080" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-5" value="" style="group;fontStyle=1;fontSize=13;" parent="1" vertex="1" connectable="0">
          <mxGeometry x="50" y="660" width="70" height="290" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-6" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-5" vertex="1">
          <mxGeometry x="50" width="20" height="289.99999999999994" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-7" value="Key creation and Validation" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-5" vertex="1">
          <mxGeometry y="134.99999999999997" width="40" height="19.999999999999996" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-9" value="" style="group;fontStyle=1;fontSize=13;" parent="1" vertex="1" connectable="0">
          <mxGeometry x="50" y="1103" width="70" height="110" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-10" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-9" vertex="1">
          <mxGeometry x="50" width="20" height="110" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-11" value="Attestation process" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-9" vertex="1">
          <mxGeometry y="51.206896551724135" width="40" height="7.586206896551724" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-12" value="Send signed (AK) quote" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="140" y="1133" as="sourcePoint" />
            <mxPoint x="378.75" y="1133" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-13" value="Send signed quote" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="381.25" y="1133" as="sourcePoint" />
            <mxPoint x="620" y="1133" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-14" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="620.0035294117652" y="1133" as="sourcePoint" />
            <mxPoint x="620.0035294117652" y="1188.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="670.6800000000001" y="1133" />
              <mxPoint x="670.6800000000001" y="1189" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-15" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate:&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate AK, Validate quote&lt;br&gt;If yes,&lt;br&gt;Sing authorization for sealedK with:&lt;br&gt;current state PCR10 and&lt;br&gt;&amp;nbsp;current state reset session&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="-7gtEHVr5MvBsyLJ3Pri-14" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="120" y="22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-16" value="Send authorization&#xa; signed (AutK)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="380" y="1193" as="targetPoint" />
            <mxPoint x="620" y="1193" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-17" value="Send authorization&#xa; signed (AutK)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="140" y="1277.5" as="targetPoint" />
            <mxPoint x="380" y="1277.5" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-18" value="" style="group;fontStyle=1;fontSize=13;" parent="1" vertex="1" connectable="0">
          <mxGeometry x="40" y="1223" width="80" height="210" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-19" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-18" vertex="1">
          <mxGeometry x="57.14285714285714" width="22.857142857142854" height="210" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-20" value="Daily life functionality" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-18" vertex="1">
          <mxGeometry y="97.75862068965517" width="45.71428571428571" height="14.482758620689657" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-21" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="630.0035294117652" y="807" as="sourcePoint" />
            <mxPoint x="630.0035294117652" y="862.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="680.6800000000001" y="807" />
              <mxPoint x="680.6800000000001" y="863" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-22" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate:&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Generate Auth_name*,&lt;br&gt;Generate Authorized.policy**,&lt;br&gt;Check in SeK_PuBData&#39;s&amp;nbsp;&lt;/b&gt;&lt;/span&gt;&lt;font style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;authPolicy&lt;/b&gt;&lt;/font&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&amp;nbsp;for:***&lt;br&gt;&amp;nbsp;&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;Authorized.policy_TPM=&lt;/b&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;Authorized.policy_Server&lt;br&gt;&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Generate random_Nonce&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;Make_credential(EKPuK,&lt;br&gt;SeK_name,&lt;/b&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;random_Nonce&lt;/b&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="-7gtEHVr5MvBsyLJ3Pri-21" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="167" y="13" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-23" value="Ack" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="0.0052" relative="1" as="geometry">
            <mxPoint x="140" y="1313" as="sourcePoint" />
            <mxPoint x="378.75" y="1313" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-24" value="Sign Data_digest (SealedKey)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="140" y="1353" as="targetPoint" />
            <mxPoint x="380" y="1353" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-25" value="Signature" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="0.0052" relative="1" as="geometry">
            <mxPoint x="140" y="1392" as="sourcePoint" />
            <mxPoint x="378.75" y="1392" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-26" value="Send data, signed data (AutKey)&#xa;and certificate (CA-&gt;SealedKey)" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="380" y="1403" as="sourcePoint" />
            <mxPoint x="1160" y="1403" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-27" value="Device stakeholder" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="1100" y="1100" width="120" height="220" as="geometry" />
        </mxCell>
        <mxCell id="82Z_mEPh2DG9AXx7ghSx-1" value="&lt;font&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;*** for this process check scheme &quot;recreating authPolicy digest&quot;&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="20" y="1350" width="440" height="20" as="geometry" />
        </mxCell>
        <mxCell id="IXNeOV9_xC59NTI-1Gqs-8" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="105" y="300" width="20" height="110" as="geometry" />
        </mxCell>
        <mxCell id="IXNeOV9_xC59NTI-1Gqs-9" value="Key provisioning" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="40" y="370" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="IXNeOV9_xC59NTI-1Gqs-10" value="Get reference measurements (Ref_Me)_" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="140" y="463" as="sourcePoint" />
            <mxPoint x="378.75" y="463" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="dKExhv86BuXlmzeER8vV-1" value="Credential" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" edge="1" parent="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="380" y="860" as="targetPoint" />
            <mxPoint x="620" y="860" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="dKExhv86BuXlmzeER8vV-2" value="Credential" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" edge="1" parent="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="140" y="860" as="targetPoint" />
            <mxPoint x="380" y="860" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="dKExhv86BuXlmzeER8vV-3" value="random_Nonce" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="140" y="949.17" as="sourcePoint" />
            <mxPoint x="380" y="949.17" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="dKExhv86BuXlmzeER8vV-4" value="" style="curved=1;endArrow=classic;html=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140.00352941176493" y="879.17" as="sourcePoint" />
            <mxPoint x="140.00352941176493" y="935.1699999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="190.68000000000006" y="879.17" />
              <mxPoint x="190.68000000000006" y="935.17" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="dKExhv86BuXlmzeER8vV-5" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Activate_credential(&lt;br&gt;EKPuK,&amp;nbsp;&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;SeK_name&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;,&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px ; font-weight: 700&quot;&gt;Credential&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;)&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="dKExhv86BuXlmzeER8vV-4">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="77" y="20" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="dKExhv86BuXlmzeER8vV-6" value="random_Nonce" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="380" y="950.0000000000001" as="sourcePoint" />
            <mxPoint x="620" y="950.0000000000001" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="dKExhv86BuXlmzeER8vV-8" value="&lt;b style=&quot;font-size: 13px&quot;&gt;If randm_nonce is valid, the SeK was stored&amp;nbsp;&lt;br&gt;&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;in the TPM and then all the information&lt;br&gt;&amp;nbsp;in SeK_PuBData was real&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="1">
          <mxGeometry x="800.0000000000001" y="939.9968627450986" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
