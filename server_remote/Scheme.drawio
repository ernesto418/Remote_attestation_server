<mxfile host="app.diagrams.net" modified="2021-10-18T08:24:37.884Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36" etag="oQA9TUqbNQoVLQ0PRtjg" version="15.5.3" type="github">
  <diagram id="kgpKYQtTHZ0yAKxKKP6v" name="Page-1">
    <mxGraphModel dx="1662" dy="882" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="3nuBFxr9cyL0pnOWT2aG-1" value="TPM2.0" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="80" y="80" width="120" height="1780" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-60" value="" style="curved=1;endArrow=classic;html=1;" parent="3nuBFxr9cyL0pnOWT2aG-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="60.00352941176493" y="580" as="sourcePoint" />
            <mxPoint x="60.00352941176493" y="635.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="110.68000000000006" y="580" />
              <mxPoint x="110.68000000000006" y="636" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-61" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Activate_credential(&lt;br&gt;EKPuK, AK_name,&lt;br&gt;credential)&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-60" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="77" y="20" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-17" value="Send authorization&#xa; signed (AutK)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="3nuBFxr9cyL0pnOWT2aG-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="60" y="1567" as="targetPoint" />
            <mxPoint x="300" y="1567" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-66" value="" style="group;fontStyle=1;fontSize=13;" parent="3nuBFxr9cyL0pnOWT2aG-1" vertex="1" connectable="0">
          <mxGeometry x="-40" y="1200" width="80" height="290" as="geometry" />
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-67" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="4jZaXwiLPurZE2urW2g0-66" vertex="1">
          <mxGeometry x="57.14285714285714" width="22.857142857142854" height="290" as="geometry" />
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-68" value="CSR" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="4jZaXwiLPurZE2urW2g0-66" vertex="1">
          <mxGeometry y="135" width="45.71428571428571" height="20" as="geometry" />
        </mxCell>
        <mxCell id="3nuBFxr9cyL0pnOWT2aG-5" value="Device" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="320" y="80" width="120" height="1750" as="geometry" />
        </mxCell>
        <mxCell id="qXhNK0rW9QVWBGsF0RSo-1" value="" style="curved=1;endArrow=classic;html=1;" parent="3nuBFxr9cyL0pnOWT2aG-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="60.00352941176493" y="652" as="sourcePoint" />
            <mxPoint x="60.00352941176493" y="707.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="110.68000000000006" y="652" />
              <mxPoint x="110.68000000000006" y="708" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qXhNK0rW9QVWBGsF0RSo-2" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;AES_dec(&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px ; font-weight: 700&quot;&gt;AutPuK_encrypted,&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;secret)&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qXhNK0rW9QVWBGsF0RSo-1" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="77" y="20" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-25" value="Signature" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="3nuBFxr9cyL0pnOWT2aG-5" edge="1">
          <mxGeometry x="0.0052" relative="1" as="geometry">
            <mxPoint x="-179.37" y="1687.76" as="sourcePoint" />
            <mxPoint x="59.379999999999995" y="1687.76" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-65" value="Send authorization&#xa; signed (AutK)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="3nuBFxr9cyL0pnOWT2aG-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="60" y="1170" as="targetPoint" />
            <mxPoint x="300" y="1170" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-78" value="Certificate" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="3nuBFxr9cyL0pnOWT2aG-5" target="3nuBFxr9cyL0pnOWT2aG-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-40.00000000000006" y="1471.8899999999999" as="targetPoint" />
            <mxPoint x="300.96000000000004" y="1470" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-62" value="Signature" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="3nuBFxr9cyL0pnOWT2aG-5" edge="1">
          <mxGeometry x="0.0052" relative="1" as="geometry">
            <mxPoint x="-179.3699999999999" y="1330.0000000000002" as="sourcePoint" />
            <mxPoint x="59.38000000000011" y="1330.0000000000002" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-69" value="Sign CSR with SeK" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="3nuBFxr9cyL0pnOWT2aG-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-180" y="1300" as="targetPoint" />
            <mxPoint x="60" y="1300" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-61" value="Send authorization&#xa; signed (AutK)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="3nuBFxr9cyL0pnOWT2aG-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-180" y="1270" as="targetPoint" />
            <mxPoint x="60" y="1270" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-63" value="" style="curved=1;endArrow=classic;html=1;" parent="3nuBFxr9cyL0pnOWT2aG-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="60.00352941176516" y="1210" as="sourcePoint" />
            <mxPoint x="60.00352941176516" y="1265.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="110.68000000000006" y="1210" />
              <mxPoint x="110.68000000000006" y="1266" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-64" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Create unsigned CSR&lt;br&gt;This step can be avoided&amp;nbsp;&lt;br&gt;if we use the CSR recieved&lt;br&gt;in the eend of KCV&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="4jZaXwiLPurZE2urW2g0-63" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="87" y="27" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-3" value="Attestor" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="560" y="80" width="120" height="1720" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-4" value="Unsigned CSR digest" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="PK25MbMjysthuU5o7wJD-3" edge="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="-180" y="1058.57" as="targetPoint" />
            <mxPoint x="70" y="1058.57" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-73" value="" style="curved=1;endArrow=classic;html=1;" parent="PK25MbMjysthuU5o7wJD-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="60.00352941176516" y="1340" as="sourcePoint" />
            <mxPoint x="60.00352941176516" y="1395.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="110.68000000000006" y="1340" />
              <mxPoint x="110.68000000000006" y="1396" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-74" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate CSR:&lt;br&gt;Correct data,&lt;br&gt;correct public key&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="4jZaXwiLPurZE2urW2g0-73" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="67" y="22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-79" value="" style="curved=1;endArrow=classic;html=1;" parent="PK25MbMjysthuU5o7wJD-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="60.00352941176516" y="980" as="sourcePoint" />
            <mxPoint x="60.00352941176516" y="1035.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="110.68000000000006" y="980" />
              <mxPoint x="110.68000000000006" y="1036" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-80" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Generate unsigned CSR digest&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="4jZaXwiLPurZE2urW2g0-79" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="127" y="25" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-15" value="READ" style="verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="184.99666666666673" y="30.000000000000142" as="targetPoint" />
            <mxPoint x="290" y="30" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-16" value="WRITE" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="290" y="50" as="sourcePoint" />
            <mxPoint x="184" y="50" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-21" value="" style="group;fontStyle=1;fontSize=13;" parent="1" vertex="1" connectable="0">
          <mxGeometry x="50" y="140" width="70" height="80" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-12" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="PK25MbMjysthuU5o7wJD-21" vertex="1">
          <mxGeometry x="50" width="20" height="80" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-14" value="Certification&lt;br&gt;Creation" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="PK25MbMjysthuU5o7wJD-21" vertex="1">
          <mxGeometry x="-10" y="30" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-22" value="" style="group;fontStyle=1;fontSize=13;" parent="1" vertex="1" connectable="0">
          <mxGeometry x="55" y="360" width="70" height="290" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-23" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="PK25MbMjysthuU5o7wJD-22" vertex="1">
          <mxGeometry x="50" y="90" width="20" height="200" as="geometry" />
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-24" value="Attune" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="PK25MbMjysthuU5o7wJD-22" vertex="1">
          <mxGeometry y="190" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-1" value="Read EK PuK" style="verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" target="PK25MbMjysthuU5o7wJD-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="960" y="160" as="targetPoint" />
            <mxPoint x="150" y="160" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-2" value="Store certificate EK cert" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" source="PK25MbMjysthuU5o7wJD-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="910" y="210" as="sourcePoint" />
            <mxPoint x="140" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-3" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="950.0035294117649" y="152" as="sourcePoint" />
            <mxPoint x="950.0035294117649" y="207.99999999999977" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000.6800000000001" y="152" />
              <mxPoint x="1000.6800000000001" y="208" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-4" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Create certificate&lt;br&gt;using MPiK&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-3" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="67" y="28" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-5" value="&lt;font style=&quot;font-size: 15px&quot;&gt;&lt;span&gt;Legend:&lt;/span&gt;&lt;br&gt;KP: key pair (PiK + PuK)&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;PuK: Public Key&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;PiK: Private Key&lt;br&gt;&lt;/span&gt;Key PubDara: Public key + Attributes key&lt;br&gt;Aut KP: Key stored in the server used to authorize the use of the sealed KP&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;Manufacturer: Creator of the IoT oracle&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;MPiK: Manufacturer PiK&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;Device: Microcontroller (or any devices) controlling the oracle&lt;/span&gt;&lt;br&gt;&lt;div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;IoT_O: IoT oracle (device + HSM)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="1100" y="453" width="520" height="170" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-9" value="&lt;b&gt;&lt;font style=&quot;font-size: 13px&quot;&gt;Device arrives&lt;br&gt;&amp;nbsp;end user&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="25" y="260" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-12" value="Send AK PuBData +&#xa;EK PuBData +&#xa;Ref_Me +&#xa;One-use key&#xa;" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry x="0.0052" y="-15" relative="1" as="geometry">
            <mxPoint x="381.25" y="538" as="sourcePoint" />
            <mxPoint x="620" y="538" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-17" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140.00352941176493" y="340" as="sourcePoint" />
            <mxPoint x="140.00352941176493" y="395.99999999999966" as="targetPoint" />
            <Array as="points">
              <mxPoint x="190.68000000000006" y="340" />
              <mxPoint x="190.68000000000006" y="396" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-18" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Create AK&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-17" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="47" y="20" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-26" value="&lt;font style=&quot;font-size: 15px&quot;&gt;*tpm2_loadexternal -G rsa -C o -u signing_key_public.pem -c signing_key.ctx -n signing_key.name&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="40" y="1887" width="670" height="20" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-48" value="CA" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="880" y="80" width="140" height="1090" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-67" value="Cert_SeK, signature, and SeK.pub" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-500" y="850" as="sourcePoint" />
            <mxPoint x="-260" y="850" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-2" value="Cert_SeK" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-740" y="844.5" as="sourcePoint" />
            <mxPoint x="-500" y="844.5" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-3" value="" style="curved=1;endArrow=classic;html=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-739.9964705882351" y="780" as="sourcePoint" />
            <mxPoint x="-739.9964705882351" y="835.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-689.3199999999999" y="780" />
              <mxPoint x="-689.3199999999999" y="836" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-4" value="&lt;span style=&quot;font-size: 13px ; font-weight: 700&quot;&gt;Sign_certification of&lt;/span&gt;&lt;br style=&quot;padding: 0px ; margin: 0px ; font-size: 13px ; font-weight: 700&quot;&gt;&lt;span style=&quot;font-size: 13px ; font-weight: 700&quot;&gt;sealed key (Cert_SeK)&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LwqqrGVOomV46JIBTcHT-3" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="77" y="15" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-8" value="" style="curved=1;endArrow=classic;html=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-259.99647058823484" y="850" as="sourcePoint" />
            <mxPoint x="-259.99647058823484" y="905.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-209.31999999999994" y="850" />
              <mxPoint x="-209.31999999999994" y="906" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-9" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate:&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;Validate&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;certificarte&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;Validate Sek&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LwqqrGVOomV46JIBTcHT-8" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="70" y="25" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-11" value="" style="endArrow=classic;html=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-70" y="870" as="sourcePoint" />
            <mxPoint x="120" y="859.83" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-63" value="" style="curved=1;endArrow=classic;html=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-739.9964705882351" y="710" as="sourcePoint" />
            <mxPoint x="-739.9964705882351" y="765.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-689.3199999999999" y="710" />
              <mxPoint x="-689.3199999999999" y="766" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-64" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Create sealed key (SeK)&lt;br&gt;sealed to AutPuK&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-63" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="77" y="15" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-66" value="Send Sealedkey_PuBData" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-740" y="767" as="sourcePoint" />
            <mxPoint x="-500" y="767" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-68" value="" style="curved=1;endArrow=classic;html=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-499.99647058823484" y="1590" as="sourcePoint" />
            <mxPoint x="-499.99647058823484" y="1645.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-449.31999999999994" y="1590" />
              <mxPoint x="-449.31999999999994" y="1646" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-69" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Nomal working process:&lt;br&gt;Generate data,&lt;br&gt;Generate Data digest&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-68" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="80" y="12" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-5" value="" style="group;fontStyle=1;fontSize=13;" parent="x-Ay-M83Ov1TleOutt_n-48" vertex="1" connectable="0">
          <mxGeometry x="-830" y="580" width="70" height="480" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-6" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-5" vertex="1">
          <mxGeometry x="50" width="20" height="479.99999999999994" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-7" value="Key creation and Validation" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-5" vertex="1">
          <mxGeometry y="223.44827586206895" width="40" height="33.103448275862064" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-9" value="" style="group;fontStyle=1;fontSize=13;" parent="x-Ay-M83Ov1TleOutt_n-48" vertex="1" connectable="0">
          <mxGeometry x="-830" y="1073" width="70" height="110" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-10" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-9" vertex="1">
          <mxGeometry x="50" width="20" height="110" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-11" value="Attestation process" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-9" vertex="1">
          <mxGeometry y="51.206896551724135" width="40" height="7.586206896551724" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-12" value="Send signed (AK) quote" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="-740" y="1103" as="sourcePoint" />
            <mxPoint x="-501.25" y="1103" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-13" value="Send signed quote" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="-498.75" y="1103" as="sourcePoint" />
            <mxPoint x="-260" y="1103" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-14" value="" style="curved=1;endArrow=classic;html=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-259.99647058823484" y="1103" as="sourcePoint" />
            <mxPoint x="-259.99647058823484" y="1158.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-209.31999999999994" y="1103" />
              <mxPoint x="-209.31999999999994" y="1159" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-15" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate:&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate AK, Validate quote&lt;br&gt;If yes,&lt;br&gt;Sing authorization for sealedK with:&lt;br&gt;current state PCR10 and&lt;br&gt;&amp;nbsp;current state reset session&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;Make_credential(EKPuK,&lt;br&gt;Ak_name,Authorization&lt;/b&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="-7gtEHVr5MvBsyLJ3Pri-14" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="120" y="22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-16" value="Send authorization&#xa; signed (AutK)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-500" y="1560" as="targetPoint" />
            <mxPoint x="-260" y="1560" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-18" value="" style="group;fontStyle=1;fontSize=13;" parent="x-Ay-M83Ov1TleOutt_n-48" vertex="1" connectable="0">
          <mxGeometry x="-840" y="1617" width="80" height="150" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-19" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-18" vertex="1">
          <mxGeometry x="57.14" y="-50" width="22.86" height="200" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-20" value="Daily life functionality" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="-7gtEHVr5MvBsyLJ3Pri-18" vertex="1">
          <mxGeometry y="69.82758620689656" width="45.71428571428571" height="10.344827586206899" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-27" value="Device stakeholder" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="x-Ay-M83Ov1TleOutt_n-48" vertex="1">
          <mxGeometry x="220" y="1260" width="120" height="340" as="geometry" />
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-10" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate certificate:&lt;br&gt;It starts with magic number&amp;nbsp;&lt;/b&gt;&lt;/span&gt;0xff544347&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;it is a attest certificate&amp;nbsp;&lt;/b&gt;&lt;/span&gt;0x8017&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;Signed by attestation key&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-48" vertex="1" connectable="0">
          <mxGeometry x="240.00352941176516" y="859.83" as="geometry" />
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-12" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate SeK:&lt;br&gt;Assert it is the SeK of our certificate&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Generate Authorized.policy&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Assert the correct&amp;nbsp;&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;Authorized.policy&lt;br&gt;&lt;/b&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;Assert the SeK attributes&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-48" vertex="1" connectable="0">
          <mxGeometry x="240.00352941176516" y="939.83" as="geometry" />
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-13" value="" style="endArrow=classic;html=1;" parent="x-Ay-M83Ov1TleOutt_n-48" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-90" y="900" as="sourcePoint" />
            <mxPoint x="160" y="939.83" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PK25MbMjysthuU5o7wJD-5" value="TPM Manufacturer" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="x-Ay-M83Ov1TleOutt_n-48" vertex="1">
          <mxGeometry width="140" height="200" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-49" value="" style="endArrow=none;html=1;strokeWidth=3;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="125" y="270" as="sourcePoint" />
            <mxPoint x="1260" y="270" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-52" value="AK PuBData + EK PuBData" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="141.25" y="500" as="sourcePoint" />
            <mxPoint x="380" y="500" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-53" value="EK PuBData" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="140" y="330" as="sourcePoint" />
            <mxPoint x="378.75" y="330" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-54" value="" style="curved=1;endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="620.0035294117652" y="537" as="sourcePoint" />
            <mxPoint x="620.0035294117652" y="592.9999999999995" as="targetPoint" />
            <Array as="points">
              <mxPoint x="670.6800000000001" y="537" />
              <mxPoint x="670.6800000000001" y="593" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-55" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Validate:&lt;br&gt;One-use key&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px ; font-weight: 700&quot;&gt;EK PuBData&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;,&lt;br&gt;Assert AK is an &lt;br&gt;attestation key (attributes)&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="x-Ay-M83Ov1TleOutt_n-54" vertex="1" connectable="0">
          <mxGeometry x="-0.3591" y="-8" relative="1" as="geometry">
            <mxPoint x="100" y="-45" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-56" value="Credential, AutPuK_encrypted&#xa; " style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry y="10" relative="1" as="geometry">
            <mxPoint x="380" y="630" as="targetPoint" />
            <mxPoint x="620" y="630" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-57" value="One-use Key, Attestor_IP" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="380" y="430" as="targetPoint" />
            <mxPoint x="620" y="430" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-58" value="One-use key to verify Device is Device,&lt;br&gt;and to lock the registration&lt;br&gt;&amp;nbsp;process to only one use" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="620" y="280" width="220" height="50" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-59" value="Send Credential" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint x="140" y="630" as="targetPoint" />
            <mxPoint x="380" y="630" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-70" value="&lt;font&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;**&lt;/span&gt;&lt;span style=&quot;color: rgb(36 , 41 , 46)&quot;&gt;&lt;font style=&quot;font-size: 15px&quot;&gt;tpm2_policyauthorize -S session.ctx -L authorized.policy -n signing_key.name&lt;/font&gt;&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="40" y="1927" width="540" height="20" as="geometry" />
        </mxCell>
        <mxCell id="82Z_mEPh2DG9AXx7ghSx-1" value="&lt;font&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;*** for this process check scheme &quot;recreating authPolicy digest&quot;&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;" parent="1" vertex="1">
          <mxGeometry x="40" y="1967" width="440" height="20" as="geometry" />
        </mxCell>
        <mxCell id="IXNeOV9_xC59NTI-1Gqs-8" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;size=0.5;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="105" y="300" width="20" height="110" as="geometry" />
        </mxCell>
        <mxCell id="IXNeOV9_xC59NTI-1Gqs-9" value="Key provisioning" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="40" y="370" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="IXNeOV9_xC59NTI-1Gqs-10" value="Get reference measurements (Ref_Me)_" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="140" y="463" as="sourcePoint" />
            <mxPoint x="378.75" y="463" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ohl9aql_d3aA6owAKOWW-1" value="&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Create Aut KP&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;AES(&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;AutPuK&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;,secret)&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Make_credential(EKPuK,&lt;br&gt;Ak_name,&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;secret&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;)&lt;br&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="1" vertex="1" connectable="0">
          <mxGeometry x="760.0035294117652" y="590" as="geometry" />
        </mxCell>
        <mxCell id="x-Ay-M83Ov1TleOutt_n-44" value="secret" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="140" y="730" as="sourcePoint" />
            <mxPoint x="380" y="730" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-14" value="" style="endArrow=classic;html=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1240" y="1039.1699999999998" as="sourcePoint" />
            <mxPoint x="1310" y="1039.1699999999998" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LwqqrGVOomV46JIBTcHT-15" value="&lt;b style=&quot;font-size: 13px&quot;&gt;Generate Authorized.policy:&lt;/b&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 13px&quot;&gt;&lt;b&gt;Generate Auth.name&lt;br&gt;Generate Policyauthorized**&lt;br&gt;&lt;/b&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="1" vertex="1" connectable="0">
          <mxGeometry x="1410.0035294117652" y="1040" as="geometry" />
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-24" value="Sign Data_digest (SealedKey)" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="140" y="1727" as="targetPoint" />
            <mxPoint x="380" y="1727" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-7gtEHVr5MvBsyLJ3Pri-26" value="Send data, signed data (AutKey)&#xa;and certificate (CA-&gt;SealedKey)" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="380" y="1797" as="sourcePoint" />
            <mxPoint x="1160" y="1797" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-75" value="CSR" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="620" y="1510" as="sourcePoint" />
            <mxPoint x="960" y="1510" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-1" value="CA" style="shape=umlLifeline;perimeter=lifelinePerimeter;container=1;collapsible=0;recursiveResize=0;rounded=0;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="900" y="1290" width="120" height="350" as="geometry" />
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-77" value="Certificate" style="verticalAlign=bottom;endArrow=block;endSize=6;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="4jZaXwiLPurZE2urW2g0-1" target="PK25MbMjysthuU5o7wJD-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-270" y="260" as="targetPoint" />
            <mxPoint x="60" y="260" as="sourcePoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4jZaXwiLPurZE2urW2g0-72" value="CSR" style="verticalAlign=bottom;endArrow=block;shadow=0;strokeWidth=1;fontStyle=1;fontSize=13;endFill=1;" parent="1" edge="1">
          <mxGeometry x="-0.089" relative="1" as="geometry">
            <mxPoint x="380" y="1420" as="sourcePoint" />
            <mxPoint x="618.75" y="1420" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
